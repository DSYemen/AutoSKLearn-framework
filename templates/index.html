{% extends "base.html" %} {% block title %}ML Framework - Home{% endblock %} {%
block content %}
<div id="app" class="space-y-6">
  <!-- Hero Section -->
  <div class="bg-white shadow-lg rounded-lg p-8">
    <h1 class="text-3xl font-bold text-gray-900 mb-4">
      Machine Learning Framework
    </h1>
    <p class="text-gray-600 mb-6">
      Upload your dataset and let our framework handle the machine learning
      pipeline automatically.
    </p>

    <!-- Upload Section -->
    <div class="space-y-4">
      <div
        id="fileDropZone"
        class="border-2 border-dashed border-gray-300 rounded-lg p-6"
      >
        <input
          type="file"
          id="fileInput"
          class="hidden"
          accept=".csv,.xlsx,.parquet"
        />
        <div class="text-center">
          <button
            id="selectFileButton"
            class="px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700"
          >
            Select File
          </button>
          <p class="mt-2 text-sm text-gray-600">
            or drag and drop your file here
          </p>
        </div>
      </div>

      <div
        id="fileInfo"
        class="flex items-center justify-between bg-gray-50 p-4 rounded-lg hidden"
      >
        <div>
          <p id="selectedFileName" class="font-semibold"></p>
          <p id="selectedFileSize" class="text-sm text-gray-600"></p>
        </div>
        <button
          id="processFileButton"
          class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50"
        >
          Process File
        </button>
      </div>
    </div>
  </div>

  <!-- Results Section -->
  <div id="resultsSection" class="bg-white shadow-lg rounded-lg p-8 hidden">
    <!-- هنا يمكنك إضافة تفاصيل النتائج -->
  </div>

  <!-- Error Alert -->
  <div
    id="errorAlert"
    class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative hidden"
    role="alert"
  >
    <strong class="font-bold">Error!</strong>
    <span id="errorMessage" class="block sm:inline"></span>
    <button
      id="closeErrorButton"
      class="absolute top-0 bottom-0 right-0 px-4 py-3"
    >
      <svg
        class="h-6 w-6"
        fill="none"
        viewBox="0 0 24 24"
        stroke="currentColor"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M6 18L18 6M6 6l12 12"
        />
      </svg>
    </button>
  </div>
</div>
{% endblock %} {% block scripts %}
<script src="{{ url_for('static', path='/js/main.js') }}"></script>
<script>
  document.addEventListener("DOMContentLoaded", () => {
    const fileInput = document.getElementById("fileInput");
    const selectFileButton = document.getElementById("selectFileButton");
    const fileDropZone = document.getElementById("fileDropZone");
    const fileInfo = document.getElementById("fileInfo");
    const selectedFileName = document.getElementById("selectedFileName");
    const selectedFileSize = document.getElementById("selectedFileSize");
    const processFileButton = document.getElementById("processFileButton");
    const errorAlert = document.getElementById("errorAlert");
    const errorMessage = document.getElementById("errorMessage");
    const closeErrorButton = document.getElementById("closeErrorButton");

    // فتح نافذة اختيار الملف عند الضغط على الزر
    selectFileButton.addEventListener("click", () => {
      fileInput.click();
    });

    // التعامل مع اختيار الملف
    fileInput.addEventListener("change", handleFileSelect);

    // التعامل مع السحب والإفلات
    fileDropZone.addEventListener("dragover", (e) => e.preventDefault());
    fileDropZone.addEventListener("drop", handleFileDrop);

    // إخفاء رسالة الخطأ عند الضغط على زر الإغلاق
    closeErrorButton.addEventListener("click", () => {
      errorAlert.classList.add("hidden");
    });

    function handleFileSelect(event) {
      const file = event.target.files[0];
      if (file) {
        appState.selectedFile = file;
        selectedFileName.textContent = file.name;
        selectedFileSize.textContent = formatFileSize(file.size);
        fileInfo.classList.remove("hidden");
      }
    }

    function handleFileDrop(event) {
      event.preventDefault();
      const file = event.dataTransfer.files[0];
      if (file) {
        appState.selectedFile = file;
        selectedFileName.textContent = file.name;
        selectedFileSize.textContent = formatFileSize(file.size);
        fileInfo.classList.remove("hidden");
      }
    }

    processFileButton.addEventListener("click", async () => {
      await processFile(); // استدعاء الدالة لمعالجة الملف
    });
  });
</script>
{% endblock %}
